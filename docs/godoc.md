<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# code

```go
import "github.com/ghowland/sireus/code"
```

## Index



# appdata

```go
import "github.com/ghowland/sireus/code/appdata"
```

## Index

- [func AverageAndFixup(runningScore float64, considerCount int) (float64, []string)](<#func-averageandfixup>)
- [func CalculateScore(action Action, actionData BotActionData) (float64, []string)](<#func-calculatescore>)
- [func GetAPIPlotData(appConfig AppConfig, c *fiber.Ctx) string](<#func-getapiplotdata>)
- [func GetCurveDataX(curveData CurveData) []float64](<#func-getcurvedatax>)
- [func GetCurveValue(curveData CurveData, x float64) float64](<#func-getcurvevalue>)
- [type Action](<#type-action>)
  - [func GetAction(botGroup BotGroup, actionName string) (Action, error)](<#func-getaction>)
- [type ActionCommand](<#type-actioncommand>)
- [type ActionCommandResult](<#type-actioncommandresult>)
- [type ActionCommandType](<#type-actioncommandtype>)
  - [func (act ActionCommandType) String() string](<#func-actioncommandtype-string>)
- [type ActionConsideration](<#type-actionconsideration>)
  - [func GetActionConsideration(action Action, considerName string) (ActionConsideration, error)](<#func-getactionconsideration>)
- [type AppConfig](<#type-appconfig>)
  - [func LoadConfig(path string) AppConfig](<#func-loadconfig>)
- [type Bot](<#type-bot>)
  - [func GetBot(site Site, botGroup BotGroup, botName string) (Bot, error)](<#func-getbot>)
- [type BotActionData](<#type-botactiondata>)
- [type BotExtractorQueryKey](<#type-botextractorquerykey>)
- [type BotForwardSequenceState](<#type-botforwardsequencestate>)
- [type BotGroup](<#type-botgroup>)
  - [func GetBotGroup(site Site, botGroupName string) (BotGroup, error)](<#func-getbotgroup>)
  - [func LoadBotGroupConfig(path string) BotGroup](<#func-loadbotgroupconfig>)
- [type BotLockTimer](<#type-botlocktimer>)
- [type BotLockTimerType](<#type-botlocktimertype>)
  - [func (bltt BotLockTimerType) String() string](<#func-botlocktimertype-string>)
- [type BotQuery](<#type-botquery>)
  - [func GetQuery(botGroup BotGroup, queryName string) (BotQuery, error)](<#func-getquery>)
- [type BotQueryType](<#type-botquerytype>)
  - [func (bqt BotQueryType) String() string](<#func-botquerytype-string>)
- [type BotVariable](<#type-botvariable>)
- [type BotVariableType](<#type-botvariabletype>)
  - [func (bvt BotVariableType) String() string](<#func-botvariabletype-string>)
- [type CurveData](<#type-curvedata>)
  - [func LoadCurveData(appConfig AppConfig, name string) CurveData](<#func-loadcurvedata>)
- [type PairBotActionData](<#type-pairbotactiondata>)
- [type PairBotActionDataList](<#type-pairbotactiondatalist>)
  - [func SortMapStringActionDataByFinalScore(input map[string]BotActionData, sortForward bool) PairBotActionDataList](<#func-sortmapstringactiondatabyfinalscore>)
  - [func (p PairBotActionDataList) Len() int](<#func-pairbotactiondatalist-len>)
  - [func (p PairBotActionDataList) Less(i, j int) bool](<#func-pairbotactiondatalist-less>)
  - [func (p PairBotActionDataList) Swap(i, j int)](<#func-pairbotactiondatalist-swap>)
- [type QueryServer](<#type-queryserver>)
  - [func GetQueryServer(site Site, name string) (QueryServer, error)](<#func-getqueryserver>)
- [type QueryServerType](<#type-queryservertype>)
  - [func (qst QueryServerType) String() string](<#func-queryservertype-string>)
- [type Site](<#type-site>)
  - [func LoadSiteConfig(appConfig AppConfig) Site](<#func-loadsiteconfig>)


## func [AverageAndFixup](<https://github.com/ghowland/sireus/blob/main/code/appdata/score.go#L59>)

```go
func AverageAndFixup(runningScore float64, considerCount int) (float64, []string)
```

This is the heuristic we use to get a good "modified average" of the Considerations to a Consideration Final Score This works well when all the ActionConsideration.Weight values are \~1.0, so that they have relative importance to each other.  Try to keep ActionConsideration.Weight values between 0.1 and 10.0 for a good result.

## func [CalculateScore](<https://github.com/ghowland/sireus/blob/main/code/appdata/score.go#L8>)

```go
func CalculateScore(action Action, actionData BotActionData) (float64, []string)
```

## func [GetAPIPlotData](<https://github.com/ghowland/sireus/blob/main/code/appdata/plot.go#L10>)

```go
func GetAPIPlotData(appConfig AppConfig, c *fiber.Ctx) string
```

## func [GetCurveDataX](<https://github.com/ghowland/sireus/blob/main/code/appdata/curves.go#L30>)

```go
func GetCurveDataX(curveData CurveData) []float64
```

## func [GetCurveValue](<https://github.com/ghowland/sireus/blob/main/code/appdata/curves.go#L40>)

```go
func GetCurveValue(curveData CurveData, x float64) float64
```

## type [Action](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L76-L88>)

Action is what is considered for execution.  It will receive a Final Score from it's Weight and Consideration Final Scores

```go
type Action struct {
    Name               string                `json:"name"`
    Info               string                `json:"info"`
    IsLaunched         bool                  `json:"is_launched"`      // If false, this will never execute.  Launching means it is configured and ready to run live.  When Actions are created, is_launched==false and must be changed so that the action could execute.
    IsDisabled         bool                  `json:"is_disabled"`      // When testing changes, disable with modifying config
    Weight             float64               `json:"weight"`           // This is the multiplier for the Final Score, from the Consideration Final Score
    WeightMin          float64               `json:"weight_min"`       // If Weight != 0, then this is the Floor value.  We will bump it to this value, if it is less than this value
    WeightThreshold    float64               `json:"weight_threshold"` // If non-0, this is the threshold to be Active, and potentially execute Actions.  If the Final Score is less than this Threshold, this Action can never run.  WeightMin and WeightThreshold are independent tests, and will have different results when used together, so take that into consideration.
    RequiredLockTimers []string              `json:"required_lock_timers"`
    RequiredStates     []string              `json:"required_states"`
    Considerations     []ActionConsideration `json:"considerations"`
    Command            ActionCommand         `json:"command"`
}
```

### func [GetAction](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group.go#L76>)

```go
func GetAction(botGroup BotGroup, actionName string) (Action, error)
```

## type [ActionCommand](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L62-L71>)

When an Action is selected for execution by it's Final Score, the ActionCommand is executed.  A command or web request.

```go
type ActionCommand struct {
    Type              ActionCommandType `json:"type"`
    Content           string            `json:"content"`
    SuccessStatus     int               `json:"success_status"`
    SuccessContent    string            `json:"success_content"`
    LockTimerDuration util.Duration     `json:"lock_timer_duration"`
    HostExecKey       string            `json:"host_exec_key"`    // Sireus Client presents this key to get commands to run
    SetBotStates      []string          `json:"set_bot_states"`   // Will Advance all of these Bot States.  Advance can only go forward in the list, or start at the very beginning.  It can't go backwards, that is invalid data.
    JournalTemplate   string            `json:"journal_template"` // Templated Text formatted with variables from the Bot.VariableValues.  This is logged in JSON log-line and can be used to create Outage Reports, etc
}
```

## type [ActionCommandResult](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L49-L57>)

When an Action is selected for execution by it's Final Score, the ActionCommand will execute and store this result.

```go
type ActionCommandResult struct {
    ActionName    string
    ResultStatus  string
    ResultContent string
    HostExecOn    string
    Started       time.Time
    Finished      time.Time
    Score         float64
}
```

## type [ActionCommandType](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L21>)

```go
type ActionCommandType int64
```

```go
const (
    ShellCommand    ActionCommandType = iota // Shell Command
    WebHttps                                 // HTTPS request
    WebHttpInsecure                          // HTTP request
    WebRPC                                   // RPC call
    NoOperation                              // Do nothing
)
```

### func \(ActionCommandType\) [String](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L31>)

```go
func (act ActionCommandType) String() string
```

## type [ActionConsideration](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L11-L18>)

Considerations are units for scoring an Action.  Each creates a Score, and they are combined to created the Consideration Final Score.

```go
type ActionConsideration struct {
    Name       string  `json:"name"`
    Weight     float64 `json:"weight"`
    CurveName  string  `json:"curve"`
    RangeStart float64 `json:"range_start"`
    RangeEnd   float64 `json:"range_end"`
    Evaluate   string  `json:"evaluate"`
}
```

### func [GetActionConsideration](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group.go#L85>)

```go
func GetActionConsideration(action Action, considerName string) (ActionConsideration, error)
```

## type [AppConfig](<https://github.com/ghowland/sireus/blob/main/code/appdata/config.go#L9-L17>)

```go
type AppConfig struct {
    WebPath               string        `json:"web_path"`
    SiteConfigPath        string        `json:"site_config_path"`
    CurvePathFormat       string        `json:"curve_path_format"`
    QueryFastInternal     util.Duration `json:"query_fast_interval"` // BotQuery.Interval is overridden when users interact with the app, so they get fast interactive responses
    QueryFastDuration     util.Duration `json:"query_fast_duration"` // Duration QueryFastInterval is maintained after the last user interaction
    ReloadTemplatesAlways bool          `json:"reload_templates_always"`
    LogTemplateParsing    bool          `json:"log_template_parsing"`
}
```

### func [LoadConfig](<https://github.com/ghowland/sireus/blob/main/code/appdata/config.go#L19>)

```go
func LoadConfig(path string) AppConfig
```

## type [Bot](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L115-L125>)

Bots the core structure for this system.  They are ephemeral and build from the Bot Group data, and store minimal data.  Bots are expected to be added or removed at any time, and there is a Timeout for Stale, Invalid, and Removed bots.

All Bots are expected to get all the data specified from the Bot Group in their Query to Variable mapping.

If a Bot is missing any data for it's variables, it is considered Invalid, because we are not operating with a full set of data.

```go
type Bot struct {
    Name                 string
    VariableValues       map[string]float64
    SortedVariableValues util.PairFloat64List // Sorted VariableValues, Handlebars helper
    StateValues          []string
    CommandHistory       []ActionCommandResult
    LockTimers           []BotLockTimer
    ActionData           map[string]BotActionData // Key is Action.Name
    SortedActionData     PairBotActionDataList    // Scored ActionData, Handlebars helper
    FreezeActions        bool                     // If true, no actions will be taken for this Bot.  Single agent control
}
```

### func [GetBot](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group.go#L67>)

```go
func GetBot(site Site, botGroup BotGroup, botName string) (Bot, error)
```

## type [BotActionData](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L94-L102>)

This stores the Final Scores and related data for all Actions, so they can be compared to determin if any Action should be executed

```go
type BotActionData struct {
    FinalScore                   float64            // Final Score is the total result of calculations to Score this action for execution
    IsAvailable                  bool               // This Action is Available (not blocked) if the FinalScore is over the WeightThreshold
    AvailableStartTime           time.Time          // Time IsAvailable started, so we can use it for an internal Evaluation variable "_available_start_time".  Stateful.
    LastExecutedActionTime       time.Time          // Last time we executed this Action.  Stateful.
    Details                      []string           // Details about the Evaluation and Scoring, to make it easier to understand the result
    ConsiderationFinalScores     map[string]float64 // Considerations Final Results for this Bot
    ConsiderationEvaluatedScores map[string]float64 // Considerations Evaluated score, but not weighted results for this Bot
}
```

## type [BotExtractorQueryKey](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L176-L179>)

This is how Bots are created.  There is a BotQuery named QueryName that will use the Key to find the name of the Bots.  Using something like "instance", "node" or "service" is recommended, that will uniquely identify a Bot inside a BotGroup's configuration.

```go
type BotExtractorQueryKey struct {
    QueryName string `json:"query_name"`
    Key       string `json:"key"`
}
```

## type [BotForwardSequenceState](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L165-L169>)

Forward Sequence State is the term I am using to describe a State Machine that only has a single forward sequence.  It can be Advanced and it can be Reset, but the state cannot go backwards.

In this way you can create a State Machine for investigating problems, trying to solve them, checking for resolution, and finally escalating and waiting for someone else to fix it.

If a resolution is detected by an Action, the action can Reset this state, starting the States process over again.

States are used to exclude Actions from being tested, so that Actions can be targetted at a specific State of a Bot's operation.  This allows segmenting logic.  Actions use Action.RequiredStates to limit when they can execute.

```go
type BotForwardSequenceState struct {
    Name   string   `json:"name"`
    Info   string   `json:"info"`
    Labels []string `json:"labels"`
}
```

## type [BotGroup](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L269-L293>)

BotGroup is used to create Bots.  Bots are the core of Sireus.  BotGroups define all the information used to populate the ephemeral Bot structure.

```go
type BotGroup struct {
    Name                   string                    `json:"name"`
    Info                   string                    `json:"info"`
    BotExtractor           BotExtractorQueryKey      `json:"bot_extractor"`
    States                 []BotForwardSequenceState `json:"states"`
    LockTimers             []BotLockTimer            `json:"lock_timers"`
    BotTimeoutStale        util.Duration             `json:"bot_timeout_stale"`         // Duration since Bot.VariableValues was last updated until this Bot is marked as Stale.  Stale bots only execute Actions from a State named "Stale", so that you can respond, but no other states actions will apply.
    BotTimeoutRemove       util.Duration             `json:"bot_timeout_remove"`        // Duration since Bot.VariableValues was last updated until this bot is removed.  Bots are ephemeral.
    BotRemoveStoreDuration util.Duration             `json:"bot_remove_store_duration"` // Duration since removal that a Bot is stored for inspection, so that you don't lose access to useful information.  If the bot returns before this duration is over, it will be resumed.  Resumption can be refused setting BotGroup.RefuseBotResumption
    RefuseBotResumption    bool                      `json:"refuse_bot_resumption"`     // If true, once a bot is removed, while it is being stored for inspect, if it returns it will not be resumed.  Instead a new bot will be created to disconnect their history, even though they share the same BotKey
    ActionThreshold        float64                   `json:"action_threshold"`          // Minimum Action Final Score to execute a command.  Allows ignoring lower scoring Actions for testing or troubleshooting
    CommandHistoryDuration util.Duration             `json:"command_history_duration"`  // How long we keep history for ActionCommandResult values
    JournalRollupStates    []string                  `json:"journal_rollup_states"`     // If any of these states become Active, then they will be rolled up into Journal collection, example: Outage Report
    JournalRollupDuration  util.Duration             `json:"journal_rollup_duration"`   // Time between a Journal Rollup ending, and another Journal Rollup beginning, so that they are grouped together.  This collects flapping outages together.
    Queries                []BotQuery                `json:"queries"`
    Variables              []BotVariable             `json:"variables"`
    Actions                []Action                  `json:"actions"`
    Bots                   []Bot

    // Invalid = Isn't getting all the information.  Stale = Information out of data.  Removed = No data for too long, removing.
    InvalidBots   []string
    StaleBots     []string
    RemovedBots   []string
    FreezeActions bool // If true, no actions will be taken for this BotGroup.  Allows group level control.
}
```

### func [GetBotGroup](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group.go#L58>)

```go
func GetBotGroup(site Site, botGroupName string) (BotGroup, error)
```

### func [LoadBotGroupConfig](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group.go#L11>)

```go
func LoadBotGroupConfig(path string) BotGroup
```

## type [BotLockTimer](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L207-L214>)

BotLockTimer is used to both block an Action from being executed, if the BotLockTimer.IsActive and has not reached the Timeout yet.  Actions can use multiple BotLockTimers which essentially act as execution "channels" where Actions execute 1 at a time.

BotLockTimeType specifies the scope of the lock.  Is it locked at the Bot level or the BotGroup level? BotGroup level locks \(LockBotGroup\) are essentially global level locks, as BotGroups do not interact with each other, as they are data silos for decision\-making.

```go
type BotLockTimer struct {
    Type           BotLockTimerType `json:"type"`
    Name           string           `json:"name"`
    Info           string           `json:"info"`
    IsActive       bool
    Timeout        time.Time
    ActivatedByBot string // Bot.Name of who set this Lock Timer, so we can track Actions
}
```

## type [BotLockTimerType](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L182>)

```go
type BotLockTimerType int64
```

```go
const (
    LockBotGroup BotLockTimerType = iota
    LockBot
)
```

### func \(BotLockTimerType\) [String](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L189>)

```go
func (bltt BotLockTimerType) String() string
```

## type [BotQuery](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L144-L151>)

These queries are stored in BotGroup, but are used to populate the Bots with query Variables.

```go
type BotQuery struct {
    QueryServer string        `json:"query_server"`
    QueryType   BotQueryType  `json:"query_type"`
    Name        string        `json:"name"`
    Info        string        `json:"info"`
    Query       string        `json:"query"`
    Interval    util.Duration `json:"interval"`
}
```

### func [GetQuery](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group.go#L49>)

```go
func GetQuery(botGroup BotGroup, queryName string) (BotQuery, error)
```

## type [BotQueryType](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L128>)

```go
type BotQueryType int64
```

```go
const (
    Range BotQueryType = iota
)
```

### func \(BotQueryType\) [String](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L134>)

```go
func (bqt BotQueryType) String() string
```

## type [BotVariable](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L251-L263>)

BotVariable is what is used for the ActionConsideration scoring process.

BotVariable is assigned in the BotGroup, which is the definition of what will be queried or synthesized into each Bot.

If Evaluate is not empty, then this will not run a Query, and instead will execute after all Query Variables are set, and will Evalutate using govaluate.Evaluate\(\) to set a new variable.

Otherwise, a query is performed, and the variable is set from the query.

Query Variables use any combination of BotKey, QueryKey and QueryKeyValue to set the variables.

If BotKey is set, only query results that have a Metric Key named BotKey that matches Bot.Name will be accepted.

If QueryKey is set, only query results that have a value with their Metric Name of QueryKey which matches QueryKeyValue will be set.

```go
type BotVariable struct {
    Type           BotVariableType `json:"type"`
    Name           string          `json:"name"`
    BotKey         string          `json:"bot_key"` // Determines which Metric matches a Bot, may change between queries
    QueryName      string          `json:"query_name"`
    QueryKey       string          `json:"query_key"`       // Metric key to extract
    QueryKeyValue  string          `json:"query_key_value"` // Metric key value to match against the QueryKey
    Evaluate       string          `json:"evaluate"`        // If this is non-empty, query will not be performed.  After query testing for other variables, this will have a final phase of processing, and will take all the query-made variables and perform govaluation.Evaluate() with this evaluate string, to set this variable.  Evaluate variables cannot use each other, only Query variables.
    BoolRangeStart float64         `json:"bool_range_start"`
    BoolRangeEnd   float64         `json:"bool_range_end"`
    BoolInvert     bool            `json:"bool_invert"`
    Export         bool            `json:"export"` // If true, this variable will be exported for Metric collection.  Normally not useful, because we just got it from the Metric system.
}
```

## type [BotVariableType](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L217>)

```go
type BotVariableType int64
```

```go
const (
    Boolean BotVariableType = iota
    Float
)
```

### func \(BotVariableType\) [String](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L224>)

```go
func (bvt BotVariableType) String() string
```

## type [CurveData](<https://github.com/ghowland/sireus/blob/main/code/appdata/curves.go#L10-L13>)

```go
type CurveData struct {
    Name   string    `json:"name"`
    Values []float64 `json:"values"`
}
```

### func [LoadCurveData](<https://github.com/ghowland/sireus/blob/main/code/appdata/curves.go#L15>)

```go
func LoadCurveData(appConfig AppConfig, name string) CurveData
```

## type [PairBotActionData](<https://github.com/ghowland/sireus/blob/main/code/appdata/fix_go_sort.go#L7-L10>)

```go
type PairBotActionData struct {
    Key   string
    Value BotActionData
}
```

## type [PairBotActionDataList](<https://github.com/ghowland/sireus/blob/main/code/appdata/fix_go_sort.go#L12>)

```go
type PairBotActionDataList []PairBotActionData
```

### func [SortMapStringActionDataByFinalScore](<https://github.com/ghowland/sireus/blob/main/code/appdata/fix_go_sort.go#L20>)

```go
func SortMapStringActionDataByFinalScore(input map[string]BotActionData, sortForward bool) PairBotActionDataList
```

### func \(PairBotActionDataList\) [Len](<https://github.com/ghowland/sireus/blob/main/code/appdata/fix_go_sort.go#L14>)

```go
func (p PairBotActionDataList) Len() int
```

### func \(PairBotActionDataList\) [Less](<https://github.com/ghowland/sireus/blob/main/code/appdata/fix_go_sort.go#L15>)

```go
func (p PairBotActionDataList) Less(i, j int) bool
```

### func \(PairBotActionDataList\) [Swap](<https://github.com/ghowland/sireus/blob/main/code/appdata/fix_go_sort.go#L18>)

```go
func (p PairBotActionDataList) Swap(i, j int)
```

## type [QueryServer](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L316-L327>)

QueryServer is where we connect to get data to populate our Bots.  example: Prometheus These are stored at a Site level, so that they can be shared by all BotGroups in a Site.

Inside a QueryServer, all QueryNames must be unique for any BotGroup, so that they can potentially be shared to reduce QueryServer traffic.  Keep this in mind when creating BotGroup.Queries.

```go
type QueryServer struct {
    ServerType          QueryServerType `json:"server_type"`
    Name                string          `json:"name"`
    Info                string          `json:"info"`
    Host                string          `json:"host"`
    Port                int             `json:"port"`
    AuthUser            string          `json:"auth_user"`
    AuthSecret          string          `json:"auth_secret"`
    DefaultStep         string          `json:"default_step"`
    DefaultDataDuration util.Duration   `json:"default_data_duration"`
    WebUrlFormat        string          `json:"web_url_format"`
}
```

### func [GetQueryServer](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group.go#L39>)

```go
func GetQueryServer(site Site, name string) (QueryServer, error)
```

## type [QueryServerType](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L296>)

```go
type QueryServerType int64
```

```go
const (
    Prometheus QueryServerType = iota
)
```

### func \(QueryServerType\) [String](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L302>)

```go
func (qst QueryServerType) String() string
```

## type [Site](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group_data.go#L333-L340>)

Top Level of the data structure.  Site silos all BotGroups and QueryServers, so that we can have multiple Sites which are using different data sets, and should not share any data with each other.

```go
type Site struct {
    Name          string        `json:"name"`
    Info          string        `json:"info"`
    BotGroupPaths []string      `json:"bot_group_paths"`
    QueryServers  []QueryServer `json:"query_servers"`
    BotGroups     []BotGroup
    FreezeActions bool // If true, no actions will be taken for this Site.  Allows control of all BotGroups.
}
```

### func [LoadSiteConfig](<https://github.com/ghowland/sireus/blob/main/code/appdata/bot_group.go#L22>)

```go
func LoadSiteConfig(appConfig AppConfig) Site
```

# extdata

```go
import "github.com/ghowland/sireus/code/extdata"
```

## Index

- [func ClearAllBotVariables(site *appdata.Site, botGroupIndex int)](<#func-clearallbotvariables>)
- [func ExtractBotsFromPromData(data PrometheusResponse, botKey string) []appdata.Bot](<#func-extractbotsfrompromdata>)
- [func GetBotEvalMapAllVariables(bot appdata.Bot) map[string]interface{}](<#func-getbotevalmapallvariables>)
- [func GetBotEvalMapOnlyQueries(bot appdata.Bot, queryVariableNames []string) map[string]interface{}](<#func-getbotevalmaponlyqueries>)
- [func SortAllVariablesAndActions(site *appdata.Site, botGroupIndex int)](<#func-sortallvariablesandactions>)
- [func UpdateBotActionConsiderations(site *appdata.Site, botGroupIndex int)](<#func-updatebotactionconsiderations>)
- [func UpdateBotGroupFromPrometheus(site *appdata.Site, botGroupIndex int)](<#func-updatebotgroupfromprometheus>)
- [func UpdateBotsFromQueries(site *appdata.Site, botGroupIndex int)](<#func-updatebotsfromqueries>)
- [func UpdateBotsWithSyntheticVariables(site *appdata.Site, botGroupIndex int)](<#func-updatebotswithsyntheticvariables>)
- [func UpdateSiteBotGroups(site *appdata.Site)](<#func-updatesitebotgroups>)
- [type PrometheusResponse](<#type-prometheusresponse>)
  - [func QueryPrometheus(host string, port int, queryType appdata.BotQueryType, query string, timeStart time.Time, duration int) PrometheusResponse](<#func-queryprometheus>)
- [type PrometheusResponseData](<#type-prometheusresponsedata>)
- [type PrometheusResponseDataResult](<#type-prometheusresponsedataresult>)
- [type QueryManager](<#type-querymanager>)
- [type QueryResult](<#type-queryresult>)


## func [ClearAllBotVariables](<https://github.com/ghowland/sireus/blob/main/code/extdata/site_common.go#L119>)

```go
func ClearAllBotVariables(site *appdata.Site, botGroupIndex int)
```

## func [ExtractBotsFromPromData](<https://github.com/ghowland/sireus/blob/main/code/extdata/prometheus.go#L73>)

```go
func ExtractBotsFromPromData(data PrometheusResponse, botKey string) []appdata.Bot
```

## func [GetBotEvalMapAllVariables](<https://github.com/ghowland/sireus/blob/main/code/extdata/site_common.go#L187>)

```go
func GetBotEvalMapAllVariables(bot appdata.Bot) map[string]interface{}
```

## func [GetBotEvalMapOnlyQueries](<https://github.com/ghowland/sireus/blob/main/code/extdata/site_common.go#L173>)

```go
func GetBotEvalMapOnlyQueries(bot appdata.Bot, queryVariableNames []string) map[string]interface{}
```

## func [SortAllVariablesAndActions](<https://github.com/ghowland/sireus/blob/main/code/extdata/site_common.go#L36>)

```go
func SortAllVariablesAndActions(site *appdata.Site, botGroupIndex int)
```

## func [UpdateBotActionConsiderations](<https://github.com/ghowland/sireus/blob/main/code/extdata/site_common.go#L54>)

```go
func UpdateBotActionConsiderations(site *appdata.Site, botGroupIndex int)
```

## func [UpdateBotGroupFromPrometheus](<https://github.com/ghowland/sireus/blob/main/code/extdata/site_common.go#L197>)

```go
func UpdateBotGroupFromPrometheus(site *appdata.Site, botGroupIndex int)
```

## func [UpdateBotsFromQueries](<https://github.com/ghowland/sireus/blob/main/code/extdata/site_common.go#L210>)

```go
func UpdateBotsFromQueries(site *appdata.Site, botGroupIndex int)
```

## func [UpdateBotsWithSyntheticVariables](<https://github.com/ghowland/sireus/blob/main/code/extdata/site_common.go#L125>)

```go
func UpdateBotsWithSyntheticVariables(site *appdata.Site, botGroupIndex int)
```

## func [UpdateSiteBotGroups](<https://github.com/ghowland/sireus/blob/main/code/extdata/site_common.go#L13>)

```go
func UpdateSiteBotGroups(site *appdata.Site)
```

## type [PrometheusResponse](<https://github.com/ghowland/sireus/blob/main/code/extdata/prometheus.go#L25-L30>)

```go
type PrometheusResponse struct {
    Status       string                 `json:"status"`
    Data         PrometheusResponseData `json:"data"`
    RequestTime  time.Time              // When the Request was made
    ResponseTime time.Time              // When the Response was received
}
```

### func [QueryPrometheus](<https://github.com/ghowland/sireus/blob/main/code/extdata/prometheus.go#L43>)

```go
func QueryPrometheus(host string, port int, queryType appdata.BotQueryType, query string, timeStart time.Time, duration int) PrometheusResponse
```

## type [PrometheusResponseData](<https://github.com/ghowland/sireus/blob/main/code/extdata/prometheus.go#L20-L23>)

```go
type PrometheusResponseData struct {
    ResultType string                         `json:"resultType"`
    Result     []PrometheusResponseDataResult `json:"result"`
}
```

## type [PrometheusResponseDataResult](<https://github.com/ghowland/sireus/blob/main/code/extdata/prometheus.go#L15-L18>)

```go
type PrometheusResponseDataResult struct {
    Metric map[string]string `json:"metric"`
    Values [][]interface{}   `json:"values"`
}
```

## type [QueryManager](<https://github.com/ghowland/sireus/blob/main/code/extdata/prometheus.go#L39-L41>)

```go
type QueryManager struct {
    Results []QueryResult
}
```

## type [QueryResult](<https://github.com/ghowland/sireus/blob/main/code/extdata/prometheus.go#L32-L37>)

```go
type QueryResult struct {
    QueryServer        string // Server this Query came from
    QueryType          appdata.BotQueryType
    QueryName          string             // The Query
    PrometheusResponse PrometheusResponse // The Response
}
```

# util

```go
import "github.com/ghowland/sireus/code/util"
```

## Index

- [Variables](<#variables>)
- [func BoolToFloatString(value bool) string](<#func-booltofloatstring>)
- [func Check(e error) bool](<#func-check>)
- [func CheckPanic(e error)](<#func-checkpanic>)
- [func Clamp(value float64, min float64, max float64) float64](<#func-clamp>)
- [func ConvertInterfaceToFloat(value interface{}) (float64, error)](<#func-convertinterfacetofloat>)
- [func FileExists(filename string) bool](<#func-fileexists>)
- [func HandlebarFormatText(format string, mapData map[string]string) string](<#func-handlebarformattext>)
- [func ParseContextBody(c *fiber.Ctx) map[string]string](<#func-parsecontextbody>)
- [func PrintJson(value interface{}) string](<#func-printjson>)
- [func RangeMapper(value float64, rangeMin float64, rangeMax float64) float64](<#func-rangemapper>)
- [func StringInSlice(a string, list []string) bool](<#func-stringinslice>)
- [type Duration](<#type-duration>)
  - [func (d Duration) MarshalJSON() ([]byte, error)](<#func-duration-marshaljson>)
  - [func (d *Duration) UnmarshalJSON(b []byte) error](<#func-duration-unmarshaljson>)
- [type PairFloat64](<#type-pairfloat64>)
- [type PairFloat64List](<#type-pairfloat64list>)
  - [func SortMapStringFloat64ByKey(input map[string]float64) PairFloat64List](<#func-sortmapstringfloat64bykey>)
  - [func SortMapStringFloat64ByValue(input map[string]float64, sortForward bool) PairFloat64List](<#func-sortmapstringfloat64byvalue>)
  - [func (p PairFloat64List) Len() int](<#func-pairfloat64list-len>)
  - [func (p PairFloat64List) Less(i, j int) bool](<#func-pairfloat64list-less>)
  - [func (p PairFloat64List) Swap(i, j int)](<#func-pairfloat64list-swap>)


## Variables

```go
var InvalidTypeFloat64 = errors.New("Value could not be converted to Float64")
```

## func [BoolToFloatString](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L95>)

```go
func BoolToFloatString(value bool) string
```

Converts a boolean to a string of "0" or "1"

## func [Check](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L13>)

```go
func Check(e error) bool
```

Call Check when we only want to log the error and wrap error testing, but it does not require an exceptional response

## func [CheckPanic](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L23>)

```go
func CheckPanic(e error)
```

Call CheckPanic for configuration errors that can't be solved.

## func [Clamp](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L79>)

```go
func Clamp(value float64, min float64, max float64) float64
```

## func [ConvertInterfaceToFloat](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L56>)

```go
func ConvertInterfaceToFloat(value interface{}) (float64, error)
```

## func [FileExists](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L30>)

```go
func FileExists(filename string) bool
```

## func [HandlebarFormatText](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L38>)

```go
func HandlebarFormatText(format string, mapData map[string]string) string
```

## func [ParseContextBody](<https://github.com/ghowland/sireus/blob/main/code/util/util_fiber_app.go#L8>)

```go
func ParseContextBody(c *fiber.Ctx) map[string]string
```

## func [PrintJson](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L103>)

```go
func PrintJson(value interface{}) string
```

## func [RangeMapper](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L84>)

```go
func RangeMapper(value float64, rangeMin float64, rangeMax float64) float64
```

Returns clamped value between 0\-1, where the value falls between the range

## func [StringInSlice](<https://github.com/ghowland/sireus/blob/main/code/util/util_common.go#L45>)

```go
func StringInSlice(a string, list []string) bool
```

## type [Duration](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_time.go#L9>)

```go
type Duration time.Duration
```

### func \(Duration\) [MarshalJSON](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_time.go#L11>)

```go
func (d Duration) MarshalJSON() ([]byte, error)
```

### func \(\*Duration\) [UnmarshalJSON](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_time.go#L15>)

```go
func (d *Duration) UnmarshalJSON(b []byte) error
```

## type [PairFloat64](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_sort.go#L7-L10>)

```go
type PairFloat64 struct {
    Key   string
    Value float64
}
```

## type [PairFloat64List](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_sort.go#L12>)

```go
type PairFloat64List []PairFloat64
```

### func [SortMapStringFloat64ByKey](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_sort.go#L18>)

```go
func SortMapStringFloat64ByKey(input map[string]float64) PairFloat64List
```

### func [SortMapStringFloat64ByValue](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_sort.go#L40>)

```go
func SortMapStringFloat64ByValue(input map[string]float64, sortForward bool) PairFloat64List
```

TODO\(ghowland\):PERF: Inefficient, but I am working quickly.  Make it better later.

### func \(PairFloat64List\) [Len](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_sort.go#L14>)

```go
func (p PairFloat64List) Len() int
```

### func \(PairFloat64List\) [Less](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_sort.go#L15>)

```go
func (p PairFloat64List) Less(i, j int) bool
```

### func \(PairFloat64List\) [Swap](<https://github.com/ghowland/sireus/blob/main/code/util/fix_go_sort.go#L16>)

```go
func (p PairFloat64List) Swap(i, j int)
```

# webapp

```go
import "github.com/ghowland/sireus/code/webapp"
```

## Index

- [func CreateHandlebarsEngine(appConfig appdata.AppConfig) *handlebars.Engine](<#func-createhandlebarsengine>)
- [func CreateWebApp(engine *handlebars.Engine) *fiber.App](<#func-createwebapp>)
- [func GetPageMapData(c *fiber.Ctx, site appdata.Site) fiber.Map](<#func-getpagemapdata>)
- [func RegisterHandlebarsHelpers()](<#func-registerhandlebarshelpers>)
- [func RegisterHandlebarsHelpers_FormatData()](<#func-registerhandlebarshelpers_formatdata>)
- [func RegisterHandlebarsHelpers_GetAppData()](<#func-registerhandlebarshelpers_getappdata>)
- [func RegisterHandlebarsHelpers_IfArrayLength()](<#func-registerhandlebarshelpers_ifarraylength>)
- [func RegisterHandlebarsHelpers_IfTests()](<#func-registerhandlebarshelpers_iftests>)
- [func RegisterHandlebarsHelpers_WithData()](<#func-registerhandlebarshelpers_withdata>)


## func [CreateHandlebarsEngine](<https://github.com/ghowland/sireus/blob/main/code/webapp/app.go#L9>)

```go
func CreateHandlebarsEngine(appConfig appdata.AppConfig) *handlebars.Engine
```

## func [CreateWebApp](<https://github.com/ghowland/sireus/blob/main/code/webapp/app.go#L29>)

```go
func CreateWebApp(engine *handlebars.Engine) *fiber.App
```

## func [GetPageMapData](<https://github.com/ghowland/sireus/blob/main/code/webapp/params.go#L9>)

```go
func GetPageMapData(c *fiber.Ctx, site appdata.Site) fiber.Map
```

## func [RegisterHandlebarsHelpers](<https://github.com/ghowland/sireus/blob/main/code/webapp/register_helpers.go#L14>)

```go
func RegisterHandlebarsHelpers()
```

## func [RegisterHandlebarsHelpers\_FormatData](<https://github.com/ghowland/sireus/blob/main/code/webapp/register_helpers.go#L106>)

```go
func RegisterHandlebarsHelpers_FormatData()
```

## func [RegisterHandlebarsHelpers\_GetAppData](<https://github.com/ghowland/sireus/blob/main/code/webapp/register_helpers.go#L89>)

```go
func RegisterHandlebarsHelpers_GetAppData()
```

## func [RegisterHandlebarsHelpers\_IfArrayLength](<https://github.com/ghowland/sireus/blob/main/code/webapp/register_helpers.go#L140>)

```go
func RegisterHandlebarsHelpers_IfArrayLength()
```

## func [RegisterHandlebarsHelpers\_IfTests](<https://github.com/ghowland/sireus/blob/main/code/webapp/register_helpers.go#L49>)

```go
func RegisterHandlebarsHelpers_IfTests()
```

## func [RegisterHandlebarsHelpers\_WithData](<https://github.com/ghowland/sireus/blob/main/code/webapp/register_helpers.go#L31>)

```go
func RegisterHandlebarsHelpers_WithData()
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
